<project name="integration" default="testAll" basedir=".">

  <!--
     This build file is usually run indirectly via Maven.

     When running this build file through Ant directly, you must
     define the slf4j.version property on the command line, e.g.:

     ant  -Dslf4j.version=1.5.4-SNAPSHOT
   -->

  <echo message="slf4j.version:  ${slf4j.version}"/>

  <path id="basicClasspath">
    <pathelement location="../logback-core/target/classes/"/>
    <pathelement location="../logback-core/target/test-classes/"/>
    <pathelement location="./target/classes/"/>
    <pathelement location="./target/test-classes/"/>
    <pathelement location="./lib/slf4j-api-${slf4j.version}.jar"/>
    <pathelement location="./src/test/input/integration/autoInit/"/>
  </path>


  <!--<path id="multiBinding">-->
    <!--<path refid="basicClasspath"/>-->
    <!--<pathelement location="./lib/slf4j-simple-${slf4j.version}.jar"/>-->
    <!--<pathelement location="./lib/jcl-over-slf4j-${slf4j.version}.jar"/>-->
  <!--</path>-->


  <target name="testAll" depends="copySLF4J_JAR, testWithoutGroovy, testConditionalsWithoutJanino"
          unless="maven.test.skip">
  </target>

  <target name="copySLF4J_JAR">
    <echo>Copying ${org.slf4j:slf4j-api:jar} to lib/</echo>
    <copy file="${org.slf4j:slf4j-api:jar}" todir="lib/" />
    <!--<copy file="${org.slf4j:slf4j-simple:jar}" todir="lib/" />-->
    <!--<copy file="${org.slf4j:jcl-over-slf4j:jar}" todir="lib/" />-->
  </target>

  <target name="testWithoutGroovy" unless="maven.test.skip">
    <junit printsummary="yes" fork="no" haltonfailure="yes">
      <classpath refid="basicClasspath"/>
      <formatter type="plain"/>
      <test fork="yes" todir="target/unit-reports"
            outfile="TEST-NoGroovy"
            name="ch.qos.logback.classic.util.InitializationIntegrationTest"/>
    </junit>
  </target>


  <target name="testConditionalsWithoutJanino" unless="maven.test.skip">
    <junit printsummary="yes" fork="no" haltonfailure="yes">
      <classpath refid="basicClasspath"/>
      <formatter type="plain"/>
      <test fork="yes" todir="target/unit-reports"
            outfile="TEST-NoJanino"
            name="ch.qos.logback.classic.boolex.ConditionalWithoutJanino"/>
    </junit>
  </target>


  <!--<target name="multipleBinding"  unless="maven.test.skip">-->
    <!--<junit printsummary="yes" fork="no" haltonfailure="yes">-->
      <!--<classpath refid="multiBinding"/>-->
      <!--<formatter type="plain"/>-->
      <!--<test fork="yes" todir="target/unit-reports"-->
            <!--outfile="TEST-MultiBinding"-->
            <!--name="org.dummy.JCLInvocation"/>-->
    <!--</junit>-->
  <!--</target>-->


</project>